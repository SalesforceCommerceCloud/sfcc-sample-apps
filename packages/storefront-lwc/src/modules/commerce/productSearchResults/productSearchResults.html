<template>
      <div class='container search-results'>
        <div class='row search-nav'></div>

        <div class='row'>
          <div class='tab-content col-12'>
            <div class='tab-pane container active' id='product-search-results' aria-expanded='true'>
              <div class='row grid-header'>
                <div class='result-count text-center col-12 col-md-9 col-sm-6 order-sm-2'>
                  <p>
                    <span if:true={loading}>Searching for </span>
                    <span if:true={loading} class='search-keywords'>{query}</span>
                    <span if:false={loading}>{products.length} Results for </span>
                    <span if:false={loading} class='search-keywords'>{query}</span>
                  </p>
                </div>
                <div class='col-6 col-sm-3 order-sm-1'>

                    <!-- TODO: LWC-BUG: below option selected={sortOption.selected} DOES NOT WORK. see renderedCallback() -->

                    <select class='custom-select' name='sort-order' onchange={newSortRule}>
                        <template for:each={sortOptions} for:item="sortOption" >
                            <option key={sortOption.id}
                                    class={sortOption.id}
                                    selected={sortOption.selected}
                                    value={sortOption.id}>
                                {sortOption.label}
                            </option>
                        </template>
                    </select>
                </div>
                  <div class='col-6 col-sm-3 d-lg-none'>
                      <button class="btn btn-primary btn-lg btn-block filter-button" onclick={toggleRefinementBar}>Filter</button>
                  </div>
              </div>

              <template if:false={loading}>
                <div class='row' if:true={hasProducts}>
                  <div class={refinementBar}>
                      <div class="filter-header">
                          <div class="header-bar d-md-none clearfix">
                              <div class="pull-left d-md-none result-count">
                                  {products.length} Results
                              </div>
                              <button class="pull-right close" onclick={toggleRefinementBar}>
                                  <span>Close </span>
                                  <i class="fa fa-close"></i>
                              </button>
                          </div>
                      </div>
                    <div class='secondary-bar'>
                        <template if:true={currentRefinements.hasRefinements} for:each={currentRefinements.values} for:item="currentRefinement">
                            <commerce-current-refinement
                                    key={currentRefinement.value}
                                    refinement={currentRefinement}>
                            </commerce-current-refinement>
                        </template>
                      <div class='reset btn btn-block btn-outline-primary' onclick={resetRefinements}>
                        Reset
                      </div>
                    </div>

                    <aside>
                      <div class='refinements'>
                        <template for:each={refinements} for:item="refinement">
                          <commerce-refinement
                            key={refinement.label}
                            refinement={refinement}>
                          </commerce-refinement>
                        </template>
                      </div>
                    </aside>
                  </div>

                  <div class='col-sm-12 col-md-9 product-list-grid'>
                    <div class='container'>
                        <commerce-productlist products={products} ></commerce-productlist>
                    </div>
                  </div>
                </div>
              </template>

            </div>
          </div>
        </div>
      </div>
</template>
